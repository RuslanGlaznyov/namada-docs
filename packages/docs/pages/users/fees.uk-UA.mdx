# Комісії в Namada

Для того, щоб врегулювати ринок попиту на блокчейн-простір Namada, до транзакцій додається комісія. Для того, щоб будь-яка транзакція Namada вважалася дійсною, необхідно сплатити відповідну комісію. Точний розмір комісії встановлюється користувачем і повинен бути більшим або дорівнювати мінімальній `gas-price`, встановленій керівництвом, яка міститься у файлі генезису в розділі `gas_cost`.

## Як сплачуються комісії
Якщо це явно вказано, плата за газ сплачується за прапором `--gas-payer`. Якщо прапор `--gas-payer` не вказано, плата за газ сплачується першим ключем у прапорі `--signing-keys`

Це означає, що в транзакції 
```shell copy
namada client transfer \
  --source my-new-acc \
  --target validator-1 \
  --token NAM \
  --amount 10 \
  --signing-keys keysha
```

обліковий запис, пов'язаний з ключем `keysha`, буде зобов'язаний сплатити комісію. Це означає, що навіть якщо акаунт `accountant` може мати позитивний баланс NAM, акаунт `keysha` повинен мати асоційований NAM, щоб сплатити комісію за транзакцію.

Користувач також може вказати прапорець `--gas-payer`, щоб вказати інший рахунок для сплати комісії. Це корисно у випадках, коли на рахунку, який підписує транзакцію, недостатньо NAM для сплати комісії. Наприклад, якщо `keysha` має баланс 5 NAM, а `accountant` має баланс 100 NAM, то наступна транзакція буде дійсною:

```shell copy
namada client transfer \
  --source my-new-acc \
  --target validator-1 \
  --token NAM \
  --amount 10 \
  --signing-keys keysha \
  --gas-payer keysha2
  ```

(Припускаючи, що `keysha2` існує і знаходиться в гаманці користувача)

Для цілей тестової мережі ми рекомендуємо [використовувати кран](../networks/testnets/pow.mdx) для отримання NAM для комісій за транзакції.

### Як розраховуються комісії
Комісія за транзакцію розраховується шляхом множення `--gas-limit` на ціну газу.
Користувач може вказати як `--gas-limit`, так і `--gas-price`. Якщо жоден з цих параметрів не вказано, використовується ліміт газу за замовчуванням та мінімальна ціна газу. Ліміт газу за замовчуванням для будь-якої транзакції наразі встановлено на `20_000`.

Мінімальна ціна на газ встановлюється у файлі генезису в розділі `gas_cost`.

## Як встановити ціну на газ та ліміт газу

Рекомендується встановлювати `"gas-limit"` на основі транзакції, що проводиться. Для того, щоб оцінити `"gas-limit"` для конкретної транзакції, слід вказати аргумент `--dry-run-wrapper`. Це означає, що транзакція симулюється, але ще не відправляється до книги. 

Наприклад, наступна команда імітує транзакцію передачі і повертає використаний газ:

```shell copy
namadac transfer \
  --source my-new-acc \
  --target validator-1 \
  --token NAM \
  --amount 10 \
  --signing-keys keysha \
  --gas-payer keysha2 \
  --dry-run-wrapper
```

На виході вийде щось на кшталт 

```md
Dry-run result: Transaction is valid. Gas used: 1785;
```
Це означає, що ми могли б обґрунтовано здійснити цю транзакцію з `gas-limit` у 2000 році.

Таким чином, при здійсненні переказу ми можемо вказати `gas-limit` наступним чином:

```shell copy
namadac transfer \
  --source my-new-acc \
  --target validator-1 \
  --token NAM \
  --amount 10 \
  --signing-keys keysha \
  --gas-payer keysha2 \
  --gas-limit 2000
```

Якщо з якихось причин ми хотіли б платити вищу плату за газ, ми також могли б вказати це наступним чином:

```shell copy
namadac transfer \
  --source my-new-acc \
  --target validator-1 \
  --token NAM \
  --amount 10 \
  --signing-keys keysha \
  --gas-payer keysha2 \
  --gas-limit 2000 \
  --gas-price 0.01
```
Це стимулюватиме валідаторів надавати перевагу цій транзакції перед транзакціями з нижчою ціною на газ.


## Сплата зборів токенами в MASP

Ви також можете сплачувати комісії за допомогою MASP. Це зроблено для того, щоб навіть якщо користувач не має NAM на своєму прозорому балансі, він все одно міг здійснювати прозорі транзакції в ланцюжку. Це ще один стимул для користувачів зберігати максимальну кількість активів на MASP.

Для того, щоб оплачувати комісії за допомогою MASP, користувач повинен вказати прапорець `--gas-spending-key` і встановити його як псевдонім витратного ключа у своєму гаманці. Це означатиме, що комісія буде списана з екранованого балансу витратного ключа і переведена на прозорий баланс `--gas-payer` (або на адресу, що відповідає першому ключу в `--signing-keys`), перш ніж буде оплачена `--gas-payer`.

Наприклад, якщо користувач має у своєму гаманці видатковий ключ `spending-key-1` і хоче оплатити комісію за транзакцію за допомогою MASP, він має виконати наступну команду:

```shell copy 
namadac transfer \
  --source keysha \
  --target address-b \
  --token OSMO \
  --amount 10 \
  --gas-payer keysha \
  --gas-spending-key spending-key-1
```

У цьому прикладі `keysha` може мати лише залишок OSMO у своєму прозорому балансі, але `spending-key-1` може мати позитивний залишок NAM у своєму екранованому балансі. У цьому випадку NAM буде переведено на прозорий баланс `keysha`, а потім використано для оплати комісії за транзакцію.

### Використання одноразового газового лічильника

Також можна використовувати одноразовий газовий платіж для оплати комісій за транзакції. Це корисно у випадках, коли користувач не бажає розкривати особу `--gas-payer`. Для того, щоб використовувати одноразовий газовий платник, користувач повинен включити прапорець `--disposable-gas-payer`, А також повинен вказати `--gas-spending-key` . Це означатиме, що плата буде списана з екранованого балансу ключа `--gas-spending-key`, і не екранована на прозорий баланс ефемерної прозорої адреси перед тим, як буде оплачена за ефемерною адресою.

Наприклад, якщо користувач має у своєму гаманці витратний ключ `spending-key-1` і хоче оплатити комісію за транзакцію, використовуючи одноразову адресу, він повинен виконати наступну команду:

```shell copy
namadac transfer \
  --source keysha \
  --target address-b \
  --token OSMO \
  --amount 10 \
  --gas-spending-key spending-key-1 \
  --disposable-gas-payer
```

