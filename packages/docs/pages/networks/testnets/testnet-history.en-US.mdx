import { Callout } from 'nextra-theme-docs'

# Upgrades
This page covers all installation steps required by various upgrades to testnets.


## Latest Upgrade

- Namada public testnet 14 (soft-upgrade hot-fix):
  - From date: 19th of October 2023 9:00 UTC
  - Namada protocol version: `v0.23.1`
  - Cometbft version: `0.37.2`
  - CHAIN_ID: `public-testnet-14.5d79b6958580`

How to upgrade to the latest testnet:
The upgrade is a soft upgrade, meaning that there is no consensus breaking change to the new binaries, and they are backwards compatible. Validators are encouraged to upgrade to the latest version of the binaries, which can be found [here](https://github.com/anoma/namada/releases/tag/v0.23.1)

Then, simply stop the current ledger and restart it with the new binaries. This can be done by running the following commands:

```bash copy
OS="Linux" # Or OS="Darwin" for Mac
wget https://github.com/anoma/namada/releases/download/v0.23.1/namada-v0.23.1-${OS}-x86_64.tar.gz
tar -xvf namada-v0.23.1-${OS}-x86_64.tar.gz --strip-components 1 -C /usr/local/bin/ #sudo may be required
killall namadan
namada --version #should output v0.23.1
NAMADA_CMT_STDOUT=true namada node ledger run
```

<Callout type="info">
Note that the `v0.23.1` Linux binaries require Ubuntu LTS, which means that some older versions of Ubuntu will not be compatible (only Ubuntu `22.04` or later). In this case, it is recommended to build from source in order to upgrade.
</Callout>

## Latest Testnet

- Namada public testnet 14:
  - From date: 5th of October 2023 17:00 UTC
  - Namada protocol version: `v0.23.0`
  - Cometbft version: `0.37.2`
  - CHAIN_ID: `public-testnet-14.5d79b6958580`


## Testnet History Timeline

- Namada public testnet 13 (offline):
  - From date: 12th of September 2023 17:00 UTC
  - Namada protocol version: `v0.22.0`
  - Cometbft version: `0.37.2`
  - CHAIN_ID: `public-testnet-13.facd514666d5`

- Namada public testnet 12:
  - From date: 17th of August 2023 17.00 UTC
  - Namada protocol version: `v0.21.1`
  - Cometbft version: `0.37.2`
  - CHAIN_ID: `public-testnet-12.fedec12f3428`

- Namada public testnet 11:
  - From date: 2nd of August 2023 17.00 UTC
  - Namada protocol version: `v0.20.1`
  - Cometbft version: `0.37.2`
  - CHAIN_ID: `public-testnet-11.cc649ddd49b0`

- Namada public testnet 10:
  - From date: 29th of June 2023 17.00 UTC
  - Namada protocol version: `v0.17.5`
  - Cometbft version: `v0.1.4-abciplus`
  - CHAIN_ID: `public-testnet-10.3718993c3648`

- Namada public testnet 9:
  - From date: 20th of June 2023 17.00 UTC
  - Namada protocol version: `v0.17.3`
  - Cometbft version: `v0.1.4-abciplus`
  - CHAIN_ID: `public-testnet-9.3718993c3648`

- Namada public testnet 8:
  - From date: 17th of May 2023 17.00 UTC
  - Namada protocol version: `v0.15.3`
  - Tendermint version: `v0.1.4-abciplus`
  - CHAIN_ID: `public-testnet-8.0.b92ef72b820`

- Namada public testnet 7:

  - From date: 24th of April 2023 17.00 UTC
  - Namada protocol version: `v0.15.1`
  - Tendermint version: `v0.1.4-abciplus`
  - CHAIN_ID: `public-testnet-7.0.3c5a38dc983`

- Namada public testnet 6:

  - From date: 29th of March 2023 17.00 UTC
  - Namada protocol version: `v0.14.3`
  - Tendermint version: `v0.1.4-abciplus`
  - CHAIN_ID: `public-testnet-6.0.a0266444b06`

- Namada public testnet 5:

  - From date: 15th of March 2023
  - Namada protocol version: `v0.14.2`
  - Tendermint version: `v0.1.4-abciplus`
  - CHAIN_ID: `public-testnet-5.0.d25aa64ace6`

- Namada public testnet 4:

  - From date: 22nd of February 2023
  - Namada protocol version: `v0.14.1`
  - Tendermint version: `v0.1.4-abciplus`
  - CHAIN_ID: `public-testnet-4.0.16a35d789f4`

- Namada public testnet 3 hotfix (did not suffice):

  - From date: 13th of February 2023
  - Namada protocol version: `v0.13.4`
  - Tendermint version: `v0.1.4-abciplus`
  - CHAIN_ID: `public-testnet-3.0.81edd4d6eb6`

- Namada public testnet 3:

  - From date: 9th of February 2023
  - Namada protocol version: `v0.13.3`
  - Tendermint version: `v0.1.4-abciplus`
  - CHAIN_ID: `public-testnet-3.0.81edd4d6eb6`

- Namada public testnet 2.1.2 hotfix:

  - From date: 25th of January 2023
  - Namada protocol version: `v0.13.3`
  - Tendermint version: `v0.1.4-abciplus`
  - CHAIN_ID: `public-testnet-2.1.4014f207f6d`

  Due to a bug, a [hotfix](https://github.com/anoma/namada/releases/tag/v0.13.3) was released.
  This needed to be installed and applied before `18:00:00 UTC` on `2023-01-25`.

- Namada public testnet 2.1.2:

  - From date: 24th of January 2023
  - Namada protocol version: `v0.13.2`
  - Tendermint version: `v0.1.4-abciplus`
  - CHAIN_ID: `public-testnet-2.1.4014f207f6d`

- Namada public testnet 2.1:
  - From date: 17th of January 2023
  - Namada protocol version: `v0.13.1-hardfork` (hardfork)
  - Tendermint version: `v0.1.4-abciplus`
  - CHAIN_ID: `public-testnet-2.0.2feaf2d718c`

The above hardfork was meant to take effect on Block Height `37370`, but some issues arose. You can read more [here](https://blog.namada.net/namada-testnet-v0-13-0-upgrade-postmortem).

- Namada public testnet 2.0:

  - From date: 12th of January 2023
  - Namada protocol version: `v0.13.0`
  - Tendermint version: `v0.1.4-abciplus`
  - CHAIN_ID: `public-testnet-2.0.2feaf2d718c`

- Namada public testnet 1:
  - Namada protocol version: `v0.12.0`
  - Tendermint version: `v0.1.4-abciplus`
  - Genesis time: 20th of December 2022 at 17:00 UTC
  - CHAIN_ID: `public-testnet-1.0.05ab4adb9db`


## Upgrade History:


***19/05/2023*** `public-testnet-8` hot-fix

Due to some issues with our mempool validation, the testnet halted starting at block height `8073`. We fixed this issue and released a hot-fix version to a subset of the validators. This was sufficient to keep the testnet going. It did require some validators to resync the testnet.
The chain was launched with chain-id `public-testnet-8.0.b92ef72b820`

***24/04/2023*** `public-testnet-7` (offline)

The testnet launched on 24/04/2023 at 17:00 UTC with the genesis validators from `public-testnet-7`. It launches with [version v0.15.1](https://github.com/anoma/namada/releases/tag/v0.15.1) 
The chain was launched with chain-id `public-testnet-7.0.3c5a38dc983`.

The intended fix to solve the storage issue was only partially solved. This led to `v0.15.3` which intended to fix these issues.


***13/02/2023*** `public-testnet-3`

On *09/02/2023* the Namada chain `public-testnet-3` halted due to a bug in the Proof of Stake implementation when handling an edge case. Over the weekend, the team were able to fix and test a new patch that resolves the issue at hand. On *13/02/2023 11:30 UTC*, we were able to recover the network by having internal validators upgrade to the new patch. We are now calling on validators to upgrade to the new testnet as well, which will allow you to interact with the recovered chain.

**Upgrading**
1. Begin by stopping all instances of the namada node
```bash copy
killall namadan
```
2. Build the new tag (or download the binaries [here](https://github.com/anoma/namada/releases/tag/v0.13.4))
```bash copy
cd namada
export NAMADA_TAG=v0.13.4
make build-release
```
3. Copy the new binaries to path. More in depth instructions can be found at [here](./environment-setup.mdx)
4. Once this has been completed, **the node must tesync from genesis** (see below)

**How to resync from genesis:**
1. As a precautionary measure, make a backup of your pregenesis keys
```bash copy
mkdir backup-pregenesis && cp -r .namada/pre-genesis backup-pregenesis/
```
2. Delete the relevant folder in .namada
```bash copy
rm -r .namada/public-testnet-3.0.81edd4d6eb6
rm .namada/public-testnet-3.0.81edd4d6eb6.toml
```
WARNING: Do not delete the entire `.namada` folder, as it contains your pre-genesis keys. If this is accidentally done, you will have to copy over the backup-pregenesis file. See [these instructions](../../operators/validators/run-your-genesis-validator.mdx) for more details
3. Rejoin the network
```bash copy
export CHAIN_ID="public-testnet-3.0.81edd4d6eb6"
namada client utils join-network \
--chain-id $CHAIN_ID --genesis-validator $ALIAS
```
4. Run the node. One can simply run the ledger again using the familiar command
```bash copy
  NAMADA_CMT_STDOUT=true namada node ledger run
  ```

Please reach out with any questions if you have any. This upgrade can be done asynchronously, but if you wish to continue validating the chain and testing our features, you must execute the above steps.

### Hotfix for Testnet `public-testnet-2.1.4014f207f6d`

***27/01/2023***

The hotfixed testnet ran during the week, when a strange bug caused the network to stall. The core team spent 1 week investigating the cause of the bug, and the result they found was quite interesting. If you are curious about the specific details of the bug, please have a read through Ray's blog post [here](https://blog.namada.net/explaining-the-namada-0-13-3-consensus-fork/). 

***25/01/2023***

At around 06:15 UTC 25/01/2023, a validator with very little stake was scheduled to become part of the active validator set. From this tx, we discovered a conversion bug between the Namada state machine and Cometbft, which lead to a crash in the node.
A patch was released [v0.13.3](https://github.com/anoma/namada/releases/tag/v0.13.3) in order to deal with this issue.


***23/01/2023***

A new testnet was released before the fortnightly testnet release schedule due to the below hardfork not working as intended. Follow the steps in [setting up a new testnet](./environment-setup.mdx)

### Hardfork v0.13.1

This hardfork is set to be instantiated at block height `37370`, which is predicted to occur at around 17.00 UTC on 18/01/2023.

**Requirements to do before 17.00 UTC 18/01/2023**

In order to install this upgrade, a user or validator must 

1. [Download the binaries](https://github.com/anoma/namada/releases/tag/v0.13.1-hardfork) or install them [from source](https://github.com/anoma/namada/releases/tag/v0.13.1-hardfork)

2. Ensure the versions are correct, such that `<PATH_TO_BINARY>/namada --version` is `v0.13.1-hardfork` 

3. Interrupt the `namada ledger` by the interrupt command `^C`

4. Install the binaries onto `$PATH` (this depends on your machine). This must be done after interrupting the ledger, as otherwise an error is likely to be thrown.

5. As soon as possible, restart the ledger by running `NAMADA_CMT_STDOUT=true namada node ledger run`

The ledger will then update correctly at the correct height. In order to ensure a smooth fork, please do this as soon as possible.

